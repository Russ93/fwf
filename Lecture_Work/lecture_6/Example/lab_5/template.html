<!DOCTYPE html>
<html ng-app='inv'>

<head>
    <meta charset=utf-8 />
    <title>Title</title>
    <style>
        html{font-family: 'Lato','Avenir',helvetica,arial,sans-serif;}
/*        label{display: block; width: 200px;}*/
    </style>
    <script src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular-resource.min.js"></script>
    
    <script>
        iapp = angular.module('inv', ['ngResource'])
        iapp.config(function($routeProvider){  //Route provider
            $routeProvider
            .when('/',{
                controller: 'homectrl',
                templateUrl: 'views/index.html'
            })
            .when('/add',{
                controller: 'homectrl',
                templateUrl : 'views/add.html'
            })
            .when('/delete/:id',{
                controller: 'homectrl',
                templateUrl: 'views/delete.html'
            })
            .when('/edit/:id',{
                controller:'homectrl',
                templateUrl: 'views/edit.html'
            })
            .otherwise({
                redirectTo: '/'
            })
        })
        
        
        iapp.factory('itemData', function ($resource) { // App Factory
            return $resource('data.json',{})
        })
        
        iapp.run(function($rootScope,itemData){
            itemData.get(function (response) {
                $rootScope.data = response.inventory;
                console.log(response)
            })
        })
        
        iapp.controller('homectrl', function ($scope,$rootScope,$location,$routeParams) {
            var myurl = document.URL.split('http://127.0.0.1:53047/template.html#/'),
                myurlaction = myurl[1].split('/'),
                action = myurlaction[0];
            console.log(action);
            if (action == ""){
                $scope.items = $rootScope.data   
            }else if(action == 'add'){
                $scope.item = {}
                $scope.add = function () {
                    $rootScope.data.push($scope.item)
                    $location.url('/index')
                }
            }else if(action == 'edit'){
                $scope.item = $rootScope.data[$routeParams.id]
                $scope.update = function () {
                    $rootScope.data[$routeParams.id] = $scope.item
                    $location.url('/index')
                }
            }else if(action == 'delete'){
                $scope.del = function (){
                    $rootScope.data.splice($routeParams.id,1)
                    $location.url('/')
                }
            }else{
                
            }
        })
    </script>
</head>

<body>
    
    <h1><a href='template.html#//'>Home</a></h1>
    <a href="template.html#/add">Add Item</a>
    
    <div ng-view></div>
    
</body>
</html>